[Unit]
Description=docker swarm agent
After=docker.service

[Service]
ExecStartPre=/usr/bin/docker rm -f %n
ExecStart=/usr/bin/docker run \
          --name %n \
          --rm \
          {{ swarm_image }} join \
          --addr={{ node_ip }}:{{ docker_port }} \
          etcd://{{ node_ip }}:{{ etcd_client_port }}/lain/swarm
ExecStop=/usr/bin/docker stop %n
Restart=always

[Install]
WantedBy=multi-user.target
